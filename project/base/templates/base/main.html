{% extends 'base/base.html' %}

{% block content %}
<main>
    <section class="hero-gradient pt-32 pb-20">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-5xl md:text-7xl font-extrabold text-gray-800 leading-tight mb-4">
                Turn Surplus into <span id="typewriter-container" class="inline-flex items-center"><span class="text-green-600" id="typewriter-text"></span><span id="cursor" class="cursor inline-block w-1 h-12 md:h-16 bg-green-600 ml-1"></span></span>
            </h1>
            <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto mb-10">
                Savr connects restaurants in India with surplus food to NGOs who feed the hungry.
                Reduce waste, build community, and make a tangible difference, one meal at a time.
            </p>
            <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-6">
                <a href="{% url 'restaurant_signup' %}" class="cta-button glow-green w-full sm:w-auto bg-green-600 text-white text-lg font-bold py-4 px-10 rounded-full shadow-lg">
                    I'm a Restaurant
                </a>
                <a href="{% url 'ngo_signup' %}" class="cta-button glow-orange w-full sm:w-auto bg-amber-500 text-white text-lg font-bold py-4 px-10 rounded-full shadow-lg">
                    We are an NGO
                </a>
            </div>
        </div>
    </section>

    <section id="how-it-works" class="py-24 bg-white">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16 reveal-on-scroll">
                <h2 class="text-4xl font-bold mb-3">Making an Impact is Easy</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">Our streamlined process makes food donation simple and efficient for everyone involved.</p>
            </div>
            <div class="grid md:grid-cols-3 gap-12 text-center">
                <div class="reveal-on-scroll">
                    <div class="bg-green-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i data-lucide="clipboard-list" class="w-10 h-10 text-green-600"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-2">1. List Your Surplus</h3>
                    <p class="text-gray-600">Restaurants use our simple form to list leftover food in under 60 seconds. Specify the dish, quantity, and pickup time.</p>
                </div>
                <div class="reveal-on-scroll" style="transition-delay: 200ms;">
                    <div class="bg-amber-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i data-lucide="bell-ring" class="w-10 h-10 text-amber-600"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-2">2. NGOs Get Notified</h3>
                    <p class="text-gray-600">Nearby, verified NGOs receive real-time alerts. They can view details and claim the donation with a single click.</p>
                </div>
                <div class="reveal-on-scroll" style="transition-delay: 400ms;">
                    <div class="bg-blue-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i data-lucide="truck" class="w-10 h-10 text-blue-600"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-2">3. Coordinate Pickup</h3>
                    <p class="text-gray-600">The NGO arranges for a swift pickup. The food reaches those who need it most, fresh and ready to serve.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="impact" class="py-24 bg-gray-900 text-white">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16 reveal-on-scroll">
                <h2 class="text-4xl font-bold mb-3">Our Collective Impact</h2>
                <p class="text-gray-300 max-w-2xl mx-auto">Together, we are fighting hunger and reducing food waste across India.</p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-8 text-center">
                <div class="reveal-on-scroll">
                    <p class="text-6xl font-extrabold text-green-400">
                        <span class="impact-number" data-target="25000">0</span>+
                    </p>
                    <p class="text-xl text-gray-300 mt-2">Meals Donated</p>
                </div>
                <div class="reveal-on-scroll" style="transition-delay: 200ms;">
                    <p class="text-6xl font-extrabold text-amber-400">
                       <span class="impact-number" data-target="350">0</span>+
                    </p>
                    <p class="text-xl text-gray-300 mt-2">Partner Restaurants</p>
                </div>
                <div class="reveal-on-scroll" style="transition-delay: 400ms;">
                    <p class="text-6xl font-extrabold text-blue-400">
                        <span class="impact-number" data-target="80">0</span>+
                    </p>
                    <p class="text-xl text-gray-300 mt-2">NGOs Onboarded</p>
                </div>
            </div>
        </div>
    </section>

    <section id="testimonials" class="py-24 bg-white">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16 reveal-on-scroll">
                <h2 class="text-4xl font-bold mb-3">What Our Partners Say</h2>
                <p class="text-gray-600">Real stories from the heart of our community.</p>
            </div>
            <div class="relative max-w-3xl mx-auto overflow-hidden reveal-on-scroll">
                <div id="testimonial-slider" class="flex transition-transform duration-500 ease-in-out">
                    <div class="w-full flex-shrink-0 px-4">
                        <div class="bg-gray-50 p-8 rounded-xl shadow-md">
                            <p class="text-gray-700 text-lg italic mb-6">"Savr is a game-changer. We've reduced our daily waste significantly and our staff feels proud to be part of this initiative. It's incredibly simple to use."</p>
                            <div class="text-right">
                                <p class="font-bold text-green-700">Priya Sharma</p>
                                <p class="text-sm text-gray-500">Owner, The Curry Leaf, Bengaluru</p>
                            </div>
                        </div>
                    </div>
                    <div class="w-full flex-shrink-0 px-4">
                        <div class="bg-gray-50 p-8 rounded-xl shadow-md">
                            <p class="text-gray-700 text-lg italic mb-6">"As an NGO, timely information is everything. The instant alerts from Savr help us plan our pickups efficiently and feed more people every night. We are grateful."</p>
                            <div class="text-right">
                                <p class="font-bold text-amber-700">Rajesh Kumar</p>
                                <p class="text-sm text-gray-500">Coordinator, Annapurna Foundation, Delhi</p>
                            </div>
                        </div>
                    </div>
                    <div class="w-full flex-shrink-0 px-4">
                       <div class="bg-gray-50 p-8 rounded-xl shadow-md">
                            <p class="text-gray-700 text-lg italic mb-6">"The platform is beautifully designed and very intuitive. Listing our surplus paneer and naan at the end of the day takes just a minute. It's a win-win."</p>
                            <div class="text-right">
                                <p class="font-bold text-green-700">Aarav Singh</p>
                                <p class="text-sm text-gray-500">Head Chef, Tandoori Nights, Mumbai</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="testimonial-dots" class="flex justify-center space-x-3 mt-8"></div>
        </div>
    </section>
</main>
{% endblock %}

{% block scripts %}
<script>

    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }

    document.addEventListener('DOMContentLoaded', function() {

        const slider = document.getElementById('testimonial-slider');
        const dotsContainer = document.getElementById('testimonial-dots');
        if (slider && dotsContainer) {
            const slides = slider.children;
            const slideCount = slides.length;
            let currentIndex = 0;
            let intervalId;

            dotsContainer.innerHTML = '';

            for (let i = 0; i < slideCount; i++) {
                const dot = document.createElement('button');
                dot.classList.add('dot', 'w-3', 'h-3', 'bg-gray-300', 'rounded-full', 'transition-all', 'duration-300');
                dot.setAttribute('aria-label', `Go to slide ${i + 1}`);
                dot.addEventListener('click', () => {
                    goToSlide(i);
                    resetInterval();
                });
                dotsContainer.appendChild(dot);
            }
            const dots = dotsContainer.children;

            function goToSlide(index) {
                if(index < 0 || index >= slideCount) return;
                currentIndex = index;
                slider.style.transform = `translateX(-${currentIndex * 100}%)`;
                updateDots();
            }

            function updateDots() {
                for (let i = 0; i < dots.length; i++) {
                    dots[i].classList.toggle('active', i === currentIndex);
                }
            }

            function nextSlide() {
                currentIndex = (currentIndex + 1) % slideCount;
                goToSlide(currentIndex);
            }

            function startInterval() {
                // Only start interval if not already running
                if (!intervalId) {
                    intervalId = setInterval(nextSlide, 5000); // Change slide every 5 seconds
                }
            }

            function resetInterval() {
                clearInterval(intervalId);
                intervalId = null; // Clear the interval ID
                startInterval();
            }

            // Initial setup
            goToSlide(0);
            startInterval();
        }

        // --- Impact Number Counter Logic ---
        const counters = document.querySelectorAll('.impact-number');
        const speed = 200; // The lower the number, the faster the count

        const animateCounter = (counter) => {
            const target = +counter.getAttribute('data-target');
            const updateCount = () => {
                const count = +counter.innerText.replace(/,/g, '');
                const increment = target / speed;

                if (count < target) {
                    counter.innerText = Math.ceil(count + increment).toLocaleString();
                    setTimeout(updateCount, 10);
                } else {
                    counter.innerText = target.toLocaleString();
                }
            };
            updateCount();
        };

        // --- Scroll Reveal Animation Logic ---
        const revealElements = document.querySelectorAll('.reveal-on-scroll');

        const revealObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');

                    const counter = entry.target.querySelector('.impact-number') || (entry.target.classList.contains('impact-number') ? entry.target : null);
                    if (counter && !counter.dataset.animated) {
                        animateCounter(counter);
                        counter.dataset.animated = 'true';
                    }

                    // Unobserve after animation to save resources
                    observer.unobserve(entry.target);
                }
            });
        }, {
            threshold: 0.1
        });

        revealElements.forEach(el => {
            revealObserver.observe(el);
        });

        // --- REVISED: Typewriter Effect Logic ---
        const typewriterElement = document.getElementById('typewriter-text');
        const cursorElement = document.getElementById('cursor');

        if (typewriterElement && cursorElement) {
            const wordToType = "Support.";
            let charIndex = 0;
            let isDeleting = false;

            function type() {
                const currentWord = wordToType;
                let typeSpeed = 150; // Standard typing speed

                if (isDeleting) {
                    // Handle deleting
                    typewriterElement.textContent = currentWord.substring(0, charIndex - 1);
                    charIndex--;
                    typeSpeed = 75; // Faster when deleting
                } else {
                    // Handle typing
                    typewriterElement.textContent = currentWord.substring(0, charIndex + 1);
                    charIndex++;
                }

                // Check for state change
                if (!isDeleting && charIndex === currentWord.length) {
                    // Word fully typed
                    isDeleting = true;
                    typeSpeed = 2000; // Pause before deleting
                } else if (isDeleting && charIndex === 0) {
                    // Word fully deleted
                    isDeleting = false;
                    typeSpeed = 500; // Pause before re-typing
                }

                setTimeout(type, typeSpeed);
            }

            // Start the effect after a brief delay
            setTimeout(type, 500);
        }
    });
 </script>
{% endblock scripts %}

